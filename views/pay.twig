{% extends '_layout.twig' %}

{% set title = 'Paiement | Los Gustos' %}
{% set footerClass = 'hide' %}

{% block content %}

<script src="https://js.stripe.com/v3/"></script>

<main id="pay">
  <section class="section">
    <div class="container">
      <h1 class="bold is-size-2 upper has-text-centered mg-b5">Paiement</h1>
      <div class="columns">
        <div class="column" id="abstract"></div>
        <div class="column">
          <p>{{error}}</p>
          <form method="post" id="payment-form">
            <div class="form-row">
              <div id="card-element"></div>
              <div id="card-errors" role="alert"></div>
            </div>
            <input type="hidden" name="id_token">
            <button class="button mainbtn upper bold mg-t2">Payer</button>
          </form>
        </div>
      </div>
    </div>
  </section>
</main>

<script src="static/js/vendors/stripe.js" charset="utf-8"></script>
<script type="text/javascript">
//RESTORE DELIVERING INFO
var delivery_cookies = JSON.parse(delivering)
var totalPrice = JSON.parse(totalPrice)
var delivering_infos = `<p class='is-size-4'>Montant à payer : ${totalPrice} €</p><br><p class="is-size-4">Livraison :</p><p>${delivery_cookies.firstName} ${delivery_cookies.lastName}</p><p>${delivery_cookies.adress}, ${delivery_cookies.postale}, ${delivery_cookies.city}</p><p>${delivery_cookies.phone}</p>`
document.getElementById('abstract').insertAdjacentHTML("afterbegin", delivering_infos)
</script>
{% endblock %}
